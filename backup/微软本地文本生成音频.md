æŠŠæŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰txtæ–‡ä»¶ï¼Œç”¨Windowsç³»ç»Ÿè‡ªå¸¦è¯­éŸ³å¼•æ“(SAPI)è½¬æ¢ä¸ºwavéŸ³é¢‘ã€‚

```
import os
import win32com.client

# ====== é…ç½®åŒº ======
TXT_DIR = r"G:\test"           # ä½ çš„txtç›®å½•
OUTPUT_DIR = r"G:\test"        # è¾“å‡ºéŸ³é¢‘ç›®å½•
VOICE_NAME = "Microsoft Huihui Desktop"  # å¯æ¢æˆ powershell -Command "(New-Object -ComObject SAPI.SpVoice).GetVoices() | ForEach-Object { $_.GetDescription() }"
RATE = 0      # è¯­é€Ÿï¼ˆ-10 ~ 10ï¼‰
VOLUME = 100  # éŸ³é‡ï¼ˆ0 ~ 100ï¼‰
# ===================

os.makedirs(OUTPUT_DIR, exist_ok=True)

speaker = win32com.client.Dispatch("SAPI.SpVoice")
speaker.Voice = [v for v in speaker.GetVoices() if VOICE_NAME in v.GetDescription()][0]
speaker.Rate = RATE
speaker.Volume = VOLUME

for file in os.listdir(TXT_DIR):
    if file.lower().endswith(".txt"):
        txt_path = os.path.join(TXT_DIR, file)
        wav_path = os.path.join(OUTPUT_DIR, os.path.splitext(file)[0] + ".wav")

        with open(txt_path, "r", encoding="utf-8") as f:
            text = f.read().strip()

        if not text:
            print(f"âš  è·³è¿‡ç©ºæ–‡ä»¶: {file}")
            continue

        print(f"ğŸ¤ æ­£åœ¨ç”Ÿæˆ: {file} â†’ {wav_path}")
        stream = win32com.client.Dispatch("SAPI.SpFileStream")
        stream.Open(wav_path, 3, False)
        speaker.AudioOutputStream = stream
        speaker.Speak(text)
        stream.Close()

print("âœ… å…¨éƒ¨è½¬æ¢å®Œæˆï¼")
```