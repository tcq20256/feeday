
åŠŸèƒ½ï¼š1. å®æ—¶æ˜¾ç¤ºé¼ æ ‡åæ ‡
2. æŒ‰ Enter é”å®šåæ ‡å¹¶å¼€å§‹å¾ªç¯æ‰§è¡Œï¼š
 â†’ ç§»åŠ¨åˆ°åæ ‡ â†’ æŒ‰ä½å·¦é”® â†’ å…‰æ ‡ä¸Šç§»30åƒç´  + æ»šè½®ä¸Šæ»‘10æ¬¡ â†’ æ¾å¼€å·¦é”®
3. æŒ‰ Esc éšæ—¶åœæ­¢é€€å‡º


```
import time
import sys
import subprocess

# ===== è‡ªåŠ¨å®‰è£…ä¾èµ– =====
required_packages = ["pyautogui", "pynput"]
for pkg in required_packages:
    try:
        __import__(pkg)
    except ImportError:
        print(f"ğŸ“¦ æœªæ‰¾åˆ° {pkg}ï¼Œæ­£åœ¨å®‰è£…...")
        subprocess.check_call([sys.executable, "-m", "pip", "install", pkg, "-i", "https://pypi.tuna.tsinghua.edu.cn/simple"])

import pyautogui
from pynput import keyboard
from pynput.mouse import Controller as MouseController, Button

# ===== é…ç½®å‚æ•° =====
SCROLL_TIMES = 10       # æ»šè½®ä¸Šæ»‘æ¬¡æ•°
SCROLL_STEP = -1        # æ¯æ¬¡æ»šè½®æ»šåŠ¨å¹…åº¦ï¼ˆè´Ÿæ•° = å†…å®¹å¾€ä¸Šï¼‰
DRAG_OFFSET = 80        # é¼ æ ‡æŒ‰ä½åä¸Šç§»çš„åƒç´ 
INTERVAL = 0.1          # æ¯è½®å¾ªç¯é—´éš”æ—¶é—´
MOVE_DURATION = 0.1     # é¼ æ ‡ç§»åŠ¨åŠ¨ç”»æ—¶é•¿

mouse = MouseController()
running = False
stop_flag = False


# ===== é”®ç›˜ç›‘å¬ =====
def on_press(key):
    global running, stop_flag
    try:
        if key == keyboard.Key.enter:
            if not running:
                print("\nğŸš€ å¼€å§‹æ‰§è¡Œå¾ªç¯ï¼ˆæŒ‰ Esc åœæ­¢ï¼‰")
                running = True
            else:
                print("âš™ å·²åœ¨è¿è¡Œä¸­")
        elif key == keyboard.Key.esc:
            print("\nâ¹ æ£€æµ‹åˆ° Escï¼Œå‡†å¤‡é€€å‡º...")
            stop_flag = True
            return False
    except Exception:
        pass


# ===== å®æ—¶æ˜¾ç¤ºé¼ æ ‡åæ ‡ =====
def show_mouse_position():
    print("ğŸ“ å®æ—¶åæ ‡æ˜¾ç¤ºä¸­...ï¼ˆæŒ‰ Enter é”å®šåæ ‡å¹¶å¼€å§‹ï¼ŒEsc é€€å‡ºï¼‰")
    while not running and not stop_flag:
        x, y = pyautogui.position()
        print(f"\rğŸ–±ï¸ å½“å‰åæ ‡: ({x}, {y})", end='', flush=True)
        time.sleep(0.1)


# ===== ä¸»æ‰§è¡Œé€»è¾‘ =====
def perform_loop(x, y):
    global stop_flag
    i = 0
    while not stop_flag:
        i += 1

        # ç§»åŠ¨åˆ°æŒ‡å®šåæ ‡
        pyautogui.moveTo(x, y, duration=MOVE_DURATION)
        time.sleep(0.05)

        # æŒ‰ä½å·¦é”®
        mouse.press(Button.left)
        time.sleep(0.05)

        # å…‰æ ‡ä¸Šç§»æŒ‡å®šåƒç´ ï¼ˆæ¨¡æ‹Ÿæ‹–æ‹½ï¼‰
        pyautogui.moveTo(x, y - DRAG_OFFSET, duration=0.15)

        # åŒæ—¶æ»šè½®ä¸Šæ»‘è‹¥å¹²æ¬¡
        for _ in range(SCROLL_TIMES):
            mouse.scroll(0, SCROLL_STEP)
            time.sleep(0.05)

        # æ¾å¼€å·¦é”®
        mouse.release(Button.left)

        print(f"\râœ… ç¬¬ {i} æ¬¡æ‹–æ‹½+ä¸Šæ»‘å®Œæˆ ({x},{y-DRAG_OFFSET})", end='', flush=True)
        time.sleep(INTERVAL)


# ===== ä¸»ç¨‹åºå…¥å£ =====
if __name__ == "__main__":
    listener = keyboard.Listener(on_press=on_press)
    listener.start()

    show_mouse_position()

    if stop_flag:
        print("\nğŸ‘‹ å·²é€€å‡ºã€‚")
        sys.exit(0)

    # é”å®šåæ ‡
    X, Y = pyautogui.position()
    print(f"\nğŸ¯ é”å®šåæ ‡ ({X}, {Y})ï¼Œå¼€å§‹æ‰§è¡Œ...")
    perform_loop(X, Y)

    print("\nğŸ æ“ä½œç»“æŸã€‚")
```