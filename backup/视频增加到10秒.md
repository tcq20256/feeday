é€’å½’æ‰«æ D:\test\è§†é¢‘ ï¼Œå°†ä¸è¶³10ç§’çš„è§†é¢‘å¤åˆ¶æ‹¼æ¥åˆ°è¶…è¿‡10ç§’
ç”Ÿæˆåç›´æ¥è¦†ç›–åŸè§†é¢‘ï¼Œæ–‡ä»¶åä¸å˜ï¼ˆåŸæ–‡ä»¶è‡ªåŠ¨å¤‡ä»½ä¸º .bakï¼‰

```
import os
import sys
import math
import shutil
import subprocess

# ===== è‡ªåŠ¨å®‰è£…ä¾èµ– =====
required_packages = ["moviepy", "tqdm"]
for pkg in required_packages:
    try:
        __import__(pkg.split('-')[0])
    except ImportError:
        print(f"ğŸ“¦ æœªæ‰¾åˆ° {pkg}ï¼Œæ­£åœ¨è‡ªåŠ¨å®‰è£…...")
        subprocess.check_call([
            sys.executable, "-m", "pip", "install", pkg, "-i", "https://pypi.tuna.tsinghua.edu.cn/simple"
        ])

# ===== æ­£å¼é€»è¾‘ =====
from moviepy.editor import VideoFileClip, concatenate_videoclips
from tqdm import tqdm

# å›ºå®šæ‰«æç›®å½•
ROOT_DIR = r"D:\test"
MIN_DURATION = 10  # ç§’
EXTS = (".mp4", ".mov", ".mkv", ".avi", ".flv", ".webm")


def extend_and_replace(video_path, min_duration=10):
    """
    å¦‚æœè§†é¢‘æ—¶é•¿å°äº min_durationï¼Œåˆ™æ‹¼æ¥å¤šæ¬¡å¹¶æ›¿æ¢åŸæ–‡ä»¶ï¼ˆå¤‡ä»½åŸå§‹ï¼‰
    """
    try:
        clip = VideoFileClip(video_path)
        duration = clip.duration
        if duration >= min_duration:
            clip.close()
            return False  # ä¸å¤„ç†

        # è®¡ç®—å€æ•°
        times = math.ceil(min_duration / duration)
        new_clip = concatenate_videoclips([clip] * times)

        # å¤‡ä»½åŸæ–‡ä»¶
        bak_path = video_path + ".bak"
        if not os.path.exists(bak_path):
            shutil.copy2(video_path, bak_path)

        temp_out = video_path + ".temp.mp4"
        print(f"ğŸ¬ {os.path.basename(video_path)} ä»… {duration:.2f}s â†’ å¤åˆ¶ {times} æ¬¡ â†’ æ›¿æ¢åŸæ–‡ä»¶")

        new_clip.write_videofile(temp_out, codec="libx264", audio_codec="aac", verbose=False, logger=None)
        clip.close()
        new_clip.close()

        # æ›¿æ¢åŸè§†é¢‘
        os.remove(video_path)
        os.rename(temp_out, video_path)
        return True

    except Exception as e:
        print(f"âš  æ— æ³•å¤„ç† {video_path}: {e}")
        return False


def process_folder(root_dir, min_duration=10, exts=EXTS):
    """
    éå†æ–‡ä»¶å¤¹ï¼Œå¤„ç†æ‰€æœ‰è§†é¢‘
    """
    video_list = []
    for root, _, files in os.walk(root_dir):
        for f in files:
            if f.lower().endswith(exts):
                video_list.append(os.path.join(root, f))

    print(f"ğŸ å…±æ£€æµ‹åˆ° {len(video_list)} ä¸ªè§†é¢‘æ–‡ä»¶\n")
    processed = 0

    for path in tqdm(video_list, desc="å¤„ç†ä¸­"):
        if extend_and_replace(path, min_duration=min_duration):
            processed += 1

    print(f"\nâœ… å·²å¤„ç† {processed} ä¸ªçŸ­è§†é¢‘ï¼ˆè‡ªåŠ¨è¦†ç›–åŸæ–‡ä»¶ï¼ŒåŸå§‹æ–‡ä»¶å·²å¤‡ä»½ä¸º .bakï¼‰")


def main():
    if not os.path.isdir(ROOT_DIR):
        print(f"âŒ ç›®å½•ä¸å­˜åœ¨: {ROOT_DIR}")
        return

    process_folder(ROOT_DIR, min_duration=MIN_DURATION)
    print("\nğŸ“ å¤„ç†å®Œæˆã€‚çŸ­è§†é¢‘å·²å»¶é•¿ï¼ŒåŸæ–‡ä»¶åä¿æŒä¸å˜ã€‚")


if __name__ == "__main__":
    main()
```